!function(t){var i=function(i,s){this.lightbox=t(i),this.defaults={keepFocusInside:!0,classes:{next:"next",prev:"prev",visuallyhidden:"visuallyhidden",states:{active:"is-active"}}},this.classes=t.extend(!0,this.defaults.classes,window.project?window.project.classes:{}),this.labels=t.extend(!0,this.defaults.labels,window.project?window.project.labels:{}),this.config=t.extend(!0,this.defaults,s||{}),this.lightboxIdentifier=this.lightbox.attr("data-lightbox-id"),this.lightboxOpenTriggers=t('button[data-open-lightbox="'+this.lightboxIdentifier+'"]'),this.lightboxCloseTriggers=t('button[data-close-lightbox="'+this.lightboxIdentifier+'"]'),this.clickedLightboxTrigger="",this.init()};t.extend(i.prototype,{init:function(){this.lightbox.append('<div class="lightbox-shadow '+this.classes.states.active+'"></div>'),this.lightboxShadow=this.lightbox.find(".lightbox-shadow"),this.bindEvents()},bindEvents:function(){t(document).on("click",'[data-open-lightbox="'+this.lightboxIdentifier+'"]',t.proxy(function(i){this.openLightbox(t(i.currentTarget))},this)),t(document).on("click",'[data-close-lightbox="'+this.lightboxIdentifier+'"]',t.proxy(function(t){this.closeLightbox()},this)),this.lightboxShadow.on("click",t.proxy(function(t){this.closeLightbox()},this)),t(document).keyup(t.proxy(function(t){27===t.keyCode&&this.closeLightbox()},this))},openLightbox:function(i){this.createGuards(),this.lightbox.attr("tabindex",-1),setTimeout(t.proxy(function(){this.lightbox.focus()},this),0),this.clickedLightboxTrigger=i,i.addClass(this.classes.states.active),this.lightbox.addClass(this.classes.states.active)},closeLightbox:function(){this.lightbox.removeClass(this.classes.states.active),this.lightboxOpenTriggers.removeClass(this.classes.states.active),this.removeGuards(),this.clickedLightboxTrigger.focus()},createGuards:function(){this.lightbox.before('<button class="lightbox-guard '+this.classes.visuallyhidden+" "+this.classes.prev+'"></button>'),this.lightbox.after('<button class="lightbox-guard '+this.classes.visuallyhidden+" "+this.classes.next+'"></button>'),this.lightboxGuards=t(".lightbox-guard"),this.lightboxGuards.on("focus",t.proxy(function(t){this.onGuardFocus(t)},this))},onGuardFocus:function(i){var s=t(i.currentTarget),e="a, button, :input, [tabindex]";this.config.keepFocusInside?s.hasClass(this.classes.prev)?this.lightbox.find(e).last().focus():this.lightbox.find(e).first().focus():this.closeLightbox()},removeGuards:function(){this.lightboxGuards.remove()}}),t.fn.lightbox=function(s){return this.each(function(){var e=t(this);if(!e.data("lightbox")){var o=new i(this,s);e.data("lightbox",o)}})}}(jQuery);