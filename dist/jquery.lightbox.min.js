!function(t){var i=function(i,s){this.lightbox=t(i),this.defaults={keepFocusInside:!0,createGallery:!1,loop:!1,animation:"fade",animationTime:250,desactivateBodyScroll:!0,labels:{navigationPrev:"Précédent",navigationPrevHidden:"Précédent",navigationNext:"Suivant",navigationNextHidden:"Suivant",closeButton:"Fermer la lightbox",closeButtonHidden:"Fermer la lightbox"},classes:{prev:"prev",next:"next",navigationPrev:"lightbox-prev-button",navigationNext:"lightbox-next-button",closeButton:"lightbox-close-button",visuallyhidden:"visuallyhidden",states:{active:"is-active",inactive:"is-inactive"}}},this.classes=t.extend(!0,this.defaults.classes,window.project?window.project.classes:{}),this.labels=t.extend(!0,this.defaults.labels,window.project?window.project.labels:{}),this.config=t.extend(!0,this.defaults,s||{}),this.publicMethods={open:t.proxy(function(){this.openLightbox("change")},this)},this.lightboxWrapper=this.lightbox.find(".lightbox-wrapper"),this.lightboxIdentifier=this.lightbox.attr("data-lightbox-id"),this.lightboxOpenTriggers=t('button[data-open-lightbox="'+this.lightboxIdentifier+'"]'),1==this.config.createGallery&&(this.galleryIdentifier=this.lightbox.attr("data-gallery"),this.galleryElements=t('[data-gallery="'+this.galleryIdentifier+'"]'),this.galleryElements.length>1&&(this.currentElementIndex=this.galleryElements.index(this.lightbox),this.currentLightbox=this.galleryElements.eq(this.currentElementIndex),this.nbLightboxIndexes=this.galleryElements.length-1,this.createNavigation())),this.init()};t.extend(i.prototype,{init:function(){this.lightbox.append('<div class="lightbox-shadow '+this.classes.states.active+'"></div>'),this.lightboxWrapper.append('<button class="'+this.classes.closeButton+'" data-close-lightbox="'+this.lightboxIdentifier+'">'+this.config.labels.closeButton+' <span class="'+this.config.classes.visuallyhidden+'">'+this.config.labels.closeButtonHidden+"</span></button>"),this.lightboxShadow=this.lightbox.find(".lightbox-shadow"),this.bindEvents()},bindEvents:function(){t(document).on("click",'[data-open-lightbox="'+this.lightboxIdentifier+'"]',t.proxy(function(t){this.openLightbox("new"),t.preventDefault()},this)),t(document).on("click",'[data-close-lightbox="'+this.lightboxIdentifier+'"]',t.proxy(function(t){this.closeLightbox("close"),t.preventDefault()},this)),this.lightboxShadow.on("click",t.proxy(function(t){this.closeLightbox("close"),t.preventDefault()},this)),t(document).keyup(t.proxy(function(t){27===t.keyCode&&this.closeLightbox("close")},this))},createNavigation:function(){this.lightboxWrapper.append('<button class="'+this.classes.navigationPrev+'">'+this.config.labels.navigationPrev+' <span class="'+this.config.classes.visuallyhidden+'">'+this.config.labels.navigationPrevHidden+"</span></button>"),this.lightboxWrapper.append('<button class="'+this.classes.navigationNext+'">'+this.config.labels.navigationNext+' <span class="'+this.config.classes.visuallyhidden+'">'+this.config.labels.navigationNextHidden+"</span></button>"),this.navigationPrev=this.lightboxWrapper.find("."+this.classes.navigationPrev),this.navigationNext=this.lightboxWrapper.find("."+this.classes.navigationNext),this.config.loop===!1&&(0===this.currentElementIndex&&this.navigationPrev.addClass(this.config.classes.states.inactive),this.currentElementIndex===this.nbLightboxIndexes&&this.navigationNext.addClass(this.config.classes.states.inactive)),this.bindNavigation()},bindNavigation:function(){this.navigationPrev.on("click",t.proxy(function(){var t;this.config.loop===!1?0==this.currentElementIndex?(t=0,this.navigationPrev.addClass(this.classes.states.inactive)):(t=this.currentElementIndex-1,this.navigationPrev.removeClass(this.classes.states.inactive),this.changeLightbox(this.galleryElements.eq(t))):(t=0!=this.currentElementIndex?this.currentElementIndex-1:this.nbLightboxIndexes,this.changeLightbox(this.galleryElements.eq(t)))},this)),this.navigationNext.on("click",t.proxy(function(){var t;this.config.loop===!1?this.currentElementIndex==this.nbLightboxIndexes?(t=this.nbLightboxIndexes,this.navigationNext.addClass(this.classes.states.inactive)):(t=this.currentElementIndex+1,this.changeLightbox(this.galleryElements.eq(t)),this.navigationNext.removeClass(this.classes.states.inactive)):(t=this.currentElementIndex<this.nbLightboxIndexes?this.currentElementIndex+1:0,this.changeLightbox(this.galleryElements.eq(t)))},this))},changeLightbox:function(t){this.closeLightbox("change");var i=t.data("lightbox");i.publicMethods.open("change")},openLightbox:function(i){this.createGuards(),this.lightbox.attr("tabindex",-1),setTimeout(t.proxy(function(){this.lightbox.focus()},this),0),this.lightbox.addClass(this.classes.states.active),this.resizeContainer(),"new"==i?"fade"==this.config.animation?this.lightbox.fadeIn(this.config.animationTime):this.lightbox.show():"fade"==this.config.animation?(this.lightboxWrapper.hide(),this.lightbox.show(),this.lightboxWrapper.fadeIn(this.config.animationTime)):this.lightbox.show(),1==this.config.desactivateBodyScroll&&t("body").css("overflow","hidden")},closeLightbox:function(i){this.lightbox.removeClass(this.classes.states.active),"close"==i&&"fade"==this.config.animation?this.lightbox.fadeOut(this.config.animationTime):this.lightbox.hide(),1==this.config.desactivateBodyScroll&&t("body").css("overflow","auto"),this.removeGuards(),this.lightboxOpenTriggers.eq(0).focus()},resizeContainer:function(){var i=parseInt(this.lightbox.css("padding-top"))+parseInt(this.lightbox.css("padding-bottom"))+parseInt(this.lightboxWrapper.css("padding-top"))+parseInt(this.lightboxWrapper.css("padding-bottom")),s=t(window).height()-i;this.lightboxWrapper.find("img").css("max-height",s),this.lightboxWrapper.find("img").css("max-width","100%"),this.lightboxWrapper.css("max-height",s)},createGuards:function(){this.lightbox.before('<button class="lightbox-guard '+this.classes.visuallyhidden+" "+this.classes.prev+'"></button>'),this.lightbox.after('<button class="lightbox-guard '+this.classes.visuallyhidden+" "+this.classes.next+'"></button>'),this.lightboxGuards=this.lightbox.prev(".lightbox-guard").add(this.lightbox.next(".lightbox-guard")),this.lightboxGuards.on("focus",t.proxy(function(t){this.onGuardFocus(t)},this))},onGuardFocus:function(i){var s=t(i.currentTarget),e="a, button, :input, [tabindex]";this.config.keepFocusInside?s.hasClass(this.classes.prev)?this.lightbox.find(e).last().focus():this.lightbox.find(e).first().focus():this.closeLightbox("close")},removeGuards:function(){this.lightboxGuards.off("focus"),this.lightboxGuards.remove()}}),t.fn.lightbox=function(s){return this.each(t.proxy(function(e,n){var o=t(n);if(!o.data("lightbox")){var a=new i(n,s);for(var h in a.publicMethods)this[h]=a.publicMethods[h];o.data("lightbox",a)}},this)),this}}(jQuery);